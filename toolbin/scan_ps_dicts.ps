%!

% -dSCANDEBUG to enable extra noise ("skipping" messages)

(rwx = Read/Write/eXecutable, - = no, . = not applicable to this type\n) print
(systemdict length is ) print systemdict length 256 string cvs print (\n) print
(Name                             type                             RWX\n) print
(---------------------------------------------------------------------\n) print

20 dict begin	% so our local stuff doesn't end up in the list

/pstring {
  dup print
  length 16 exch sub
  0 1 3 -1 roll {pop ( ) print} for
} def

/visited systemdict length 3 mul dict def
/operator_list systemdict length 3 mul dict def

/operator_name {	% convert operator to a name
  /S 256 string def
  /F S /NullEncode filter def
  F exch write==only
  F closefile
  S (\000) search
  { exch pop exch pop } { S } ifelse
  % trim trailing nulls from the string.
  cvn
} def

/nest_level -1 def
/indent {
  (                             ) 0 nest_level 2 mul getinterval print
} def

/rwx {
  dup type
  dup /arraytype eq exch
  dup /packedarraytype eq exch
  dup /dicttype eq exch
  dup /filetype eq exch
  /stringtype eq
  or
  or
  or
  or {
    dup rcheck {(r) print}{(-) print} ifelse
    dup wcheck {(w) print}{(-) print} ifelse
  }{
    (..) print
  } ifelse
  dup xcheck {(x ) print}{(- ) print} ifelse
} def

/lsitem {
  indent
  /item_name 2 index  def
  dup rwx
  type 16 string cvs pstring
  item_name
  = flush
} def

/add_op_definition {
   /SCANDEBUG where { pop (add op def: ) print 1 index =only ( ) print dup = } if
   operator_list 2 index known not {
     operator_list 2 index 2 dict put
   } if
   operator_list 2 index get exch /def
   put
   pop
} def

/add_op_reference {
   /SCANDEBUG where { pop (add op ref ) print 1 index =only ( ) print dup = } if
   operator_list 2 index known not {
     operator_list 2 index 2 dict put
   } if
   operator_list 2 index get exch /ref
   put
   pop
} def

/show_dictionary {
  {
    1 index whitelist exch
    known not {
    5 dict begin
    indent
    lsitem
    dup type /operatortype eq {
      1 index 3 index add_op_definition
    } if
    dup type /dicttype eq {
      check_dictionary
    } {
      dup type /arraytype eq 1 index type /packedarraytype eq or {
        1 index 3 index add_op_definition
        dup rcheck {
          exch pop check_array
        } {
          pop pop
        } ifelse
      } {
        pop pop
      } ifelse
    } ifelse
    end
    } {
      pop
      /SCANDEBUG where { pop (skipping ') print dup =only (') = flush } if
      pop
    }
    ifelse
  } forall
} def

/check_array {
  /nest_level nest_level 1 add store
  /i 0 def
  {
    dup type /operatortype eq {
      dup operator_name
      /SCANDEBUG where { pop dup /--.forceput-- eq { (.forceput in ) print item_name = } if } if
      item_name add_op_reference
    } if
    dup type /arrayttype eq 1 index type /packedarraytype eq or {
      dup
      dup wcheck {
        indent (writable array, element ) print i =only (: )  print dup ==
      } if
      dup rcheck {
        check_array
      } {
        pop
      } ifelse
    } if
    dup type /dicttype eq {
      dup wcheck {
        indent (writable dict, element: ) print i =only (: ) print dup { exch ==only (	) print == exit } forall
      } if
      indent ( dict, element: ) print i =
      (unknown) 1 index dup systemdict ne {
        check_dictionary
     } {
       pop pop
     } ifelse
    } if
    pop
    /i i 1 add def
  } forall
  /nest_level nest_level 1 sub store
} def

/check_dictionary {
  /nest_level nest_level 1 add store
  5 dict begin
  visited 2 index known {
    pop pop
  } {
    visited 2 index true put
    dup rcheck {
      indent (-------------------- Dumping dict: ) print 1 index 256 string cvs print ( length: ) print dup length =
      show_dictionary
      indent (==================== Done with dict: ) print 256 string cvs =
    } {
      indent (-------------------- Cannot read dict: ) print 1 index 256 string cvs =
      pop pop
    } ifelse
  } ifelse
  end
  /nest_level nest_level 1 sub store
} def

% We have have both forms of everything, the "bare" operator and the form bracketed by '--'
% since that's the printed form for the final "usage" section.
/whitelist
<<
(AdobeGlyphList) cvn //null
(ReverseAdobeGlyphList) cvn //null
($error) cvn //null
([) cvn //null
(]) cvn //null
(<<) cvn //null
(=) cvn //null
(==) cvn //null
(>>) cvn //null
(abs) cvn //null
(add) cvn //null
(aload) cvn //null
(anchorsearch) cvn //null
(and) cvn //null
(arc) cvn //null
(arcn) cvn //null
(arct) cvn //null
(arcto) cvn //null
(array) cvn //null
(ashow) cvn //null
(astore) cvn //null
(atan) cvn //null
(awidthshow) cvn //null
(begin) cvn //null
(bind) cvn //null
(bitshift) cvn //null
(bytesavailable) cvn //null
(ceiling) cvn //null
(charpath) cvn //null
(clear) cvn //null
(cleardictstack) cvn //null
(cleartomark) cvn //null
(clip) cvn //null
(clippath) cvn //null
(cliprestore) cvn //null
(clipsave) cvn //null
(closefile) cvn //null
(closepath) cvn //null
(colorimage) cvn //null
(composefont) cvn //null
(concat) cvn //null
(concatmatrix) cvn //null
(copy) cvn //null
(copypage) cvn //null
(cos) cvn //null
(count) cvn //null
(countdictstack) cvn //null
(countexecstack) cvn //null
(counttomark) cvn //null
(cshow) cvn //null
(currentblackgeneration) cvn //null
(currentcacheparams) cvn //null
(currentcmykcolor) cvn //null
(currentcolor) cvn //null
(currentcolorrendering) cvn //null
(currentcolorscreen) cvn //null
(currentcolorspace) cvn //null
(currentcolortransfer) cvn //null
(currentdash) cvn //null
(currentdevparams) cvn //null
(currentdict) cvn //null
(currentfile) cvn //null
(currentflat) cvn //null
(currentglobal) cvn //null
(currentgray) cvn //null
(currentgstate) cvn //null
(currenthalftone) cvn //null
(currenthsbcolor) cvn //null
(currentlinecap) cvn //null
(currentlinejoin) cvn //null
(currentlinewidth) cvn //null
(currentmatrix) cvn //null
(currentmiterlimit) cvn //null
(currentobjectformat) cvn //null
(currentoverprint) cvn //null
(currentpacking) cvn //null
(currentpagedevice) cvn //null
(currentpoint) cvn //null
(currentrgbcolor) cvn //null
(currentscreen) cvn //null
(currentsmoothness) cvn //null
(currentstrokeadjust) cvn //null
(currentsystemparams) cvn //null
(currenttransfer) cvn //null
(currentundercolorremoval) cvn //null
(currentuserparams) cvn //null
(curveto) cvn //null
(cvi) cvn //null
(cvlit) cvn //null
(cvn) cvn //null
(cvr) cvn //null
(cvrs) cvn //null
(cvs) cvn //null
(cvx) cvn //null
(def) cvn //null
(defaultmatrix) cvn //null
(definefont) cvn //null
(defineresource) cvn //null
(defineuserobject) cvn //null
(deletefile) cvn //null
(dict) cvn //null
(dictstack) cvn //null
(div) cvn //null
(dtransform) cvn //null
(dup) cvn //null
(echo) cvn //null
(end) cvn //null
(eoclip) cvn //null
(eofill) cvn //null
(eq) cvn //null
(erasepage) cvn //null
(errordict) cvn //null
(exch) cvn //null
(exec) cvn //null
(execform) cvn //null
(execstack) cvn //null
(execuserobject) cvn //null
(executeonly) cvn //null
(executive) cvn //null
(exit) cvn //null
(exp) cvn //null
(false) cvn //null
(file) cvn //null
(filenameforall) cvn //null
(fileposition) cvn //null
(fill) cvn //null
(filter) cvn //null
(findcolorrendering) cvn //null
(findencoding) cvn //null
(findfont) cvn //null
(findresource) cvn //null
(flattenpath) cvn //null
(floor) cvn //null
(flush) cvn //null
(flushfile) cvn //null
(FontDirectory) cvn //null
(for) cvn //null
(forall) cvn //null
(gcheck) cvn //null
(ge) cvn //null
(get) cvn //null
(getinterval) cvn //null
(globaldict) cvn //null
(GlobalFontDirectory) cvn //null
(glyphshow) cvn //null
(grestore) cvn //null
(grestoreall) cvn //null
(gsave) cvn //null
(gstate) cvn //null
(gt) cvn //null
(identmatrix) cvn //null
(idiv) cvn //null
(idtransform) cvn //null
(if) cvn //null
(ifelse) cvn //null
(image) cvn //null
(imagemask) cvn //null
(index) cvn //null
(ineofill) cvn //null
(infill) cvn //null
(initclip) cvn //null
(initgraphics) cvn //null
(initmatrix) cvn //null
(instroke) cvn //null
(inueofill) cvn //null
(inufill) cvn //null
(inustroke) cvn //null
(invertmatrix) cvn //null
(ISOLatin1Encoding) cvn //null
(itransform) cvn //null
(known) cvn //null
(kshow) cvn //null
(languagelevel) cvn //null
(le) cvn //null
(length) cvn //null
(lineto) cvn //null
(ln) cvn //null
(load) cvn //null
(log) cvn //null
(loop) cvn //null
(lt) cvn //null
(makefont) cvn //null
(makepattern) cvn //null
(mark) cvn //null
(matrix) cvn //null
(maxlength) cvn //null
(mod) cvn //null
(moveto) cvn //null
(mul) cvn //null
(ne) cvn //null
(neg) cvn //null
(newpath) cvn //null
(noaccess) cvn //null
(not) cvn //null
(null) cvn //null
(nulldevice) cvn //null
(or) cvn //null
(packedarray) cvn //null
(pathbbox) cvn //null
(pathforall) cvn //null
(pop) cvn //null
(printobject) cvn //null
(product) cvn //null
(prompt) cvn //null
(pstack) cvn //null
(put) cvn //null
(putinterval) cvn //null
(quit) cvn //null
(rand) cvn //null
(rcheck) cvn //null
(rcurveto) cvn //null
(read) cvn //null
(readhexstring) cvn //null
(readline) cvn //null
(readonly) cvn //null
(readstring) cvn //null
(realtime) cvn //null
(rectclip) cvn //null
(rectfill) cvn //null
(rectstroke) cvn //null
(renamefile) cvn //null
(repeat) cvn //null
(resetfile) cvn //null
(resourceforall) cvn //null
(resourcestatus) cvn //null
(restore) cvn //null
(reversepath) cvn //null
(revision) cvn //null
(rlineto) cvn //null
(rmoveto) cvn //null
(roll) cvn //null
(rotate) cvn //null
(round) cvn //null
(rrand) cvn //null
(run) cvn //null
(save) cvn //null
(scale) cvn //null
(scalefont) cvn //null
(search) cvn //null
(selectfont) cvn //null
(serialnumber) cvn //null
(setbbox) cvn //null
(setblackgeneration) cvn //null
(setcachedevice) cvn //null
(setcachedevice2) cvn //null
(setcachelimit) cvn //null
(setcacheparams) cvn //null
(setcharwidth) cvn //null
(setcmykcolor) cvn //null
(setcolor) cvn //null
(setcolorrendering) cvn //null
(setcolorscreen) cvn //null
(setcolorspace) cvn //null
(setcolortransfer) cvn //null
(setdash) cvn //null
(setdevparams) cvn //null
(setfileposition) cvn //null
(setflat) cvn //null
(setfont) cvn //null
(setglobal) cvn //null
(setgray) cvn //null
(setgstate) cvn //null
(sethalftone) cvn //null
(sethsbcolor) cvn //null
(setlinecap) cvn //null
(setlinejoin) cvn //null
(setlinewidth) cvn //null
(setmatrix) cvn //null
(setmiterlimit) cvn //null
(setobjectformat) cvn //null
(setoverprint) cvn //null
(setpacking) cvn //null
(setpagedevice) cvn //null
(setpattern) cvn //null
(setrgbcolor) cvn //null
(setscreen) cvn //null
(setsmoothness) cvn //null
(setstrokeadjust) cvn //null
(setsystemparams) cvn //null
(settransfer) cvn //null
(setucacheparams) cvn //null
(setundercolorremoval) cvn //null
(setuserparams) cvn //null
(setvmthreshold) cvn //null
(shfill) cvn //null
(show) cvn //null
(showpage) cvn //null
(sin) cvn //null
(sqrt) cvn //null
(srand) cvn //null
(stack) cvn //null
(StandardEncoding) cvn //null
(start) cvn //null
(startjob) cvn //null
(status) cvn //null
(stop) cvn //null
(stopped) cvn //null
(store) cvn //null
(string) cvn //null
(stringwidth) cvn //null
(stroke) cvn //null
(strokepath) cvn //null
(sub) cvn //null
(systemdict) cvn //null
(token) cvn //null
(transform) cvn //null
(translate) cvn //null
(true) cvn //null
(truncate) cvn //null
(type) cvn //null
(uappend) cvn //null
(ucache) cvn //null
(ucachestatus) cvn //null
(ueofill) cvn //null
(ufill) cvn //null
(undef) cvn //null
(undefinefont) cvn //null
(undefineresource) cvn //null
(undefineuserobject) cvn //null
(upath) cvn //null
(userdict) cvn //null
(UserObjects) cvn //null
(usertime) cvn //null
(ustroke) cvn //null
(ustrokepath) cvn //null
(version) cvn //null
(vmreclaim) cvn //null
(vmstatus) cvn //null
(wcheck) cvn //null
(where) cvn //null
(widthshow) cvn //null
(write) cvn //null
(writehexstring) cvn //null
(writeobject) cvn //null
(writestring) cvn //null
(xcheck) cvn //null
(xor) cvn //null
(xshow) cvn //null
(xyshow) cvn //null
(yshow) cvn //null
(%Type1BuildChar) cvn //null
(%Type1BuildGlyph) cvn //null
(.begintransparencygroup) cvn //null
(.begintransparencymaskgroup) cvn //null
(.bind) cvn //null
(.bindnow) cvn //null
(.currentoverprintmode) cvn //null
(.dicttomark) cvn //null
(.endtransparencygroup) cvn //null
(.fileposition) cvn //null
(.knownget) cvn //null
(.locksafe) cvn //null
(.makeoperator) cvn //null
(.setblendmode) cvn //null
(.setdebug) cvn //null
(.setopacityalpha) cvn //null
(.setoverprintmode) cvn //null
(.setsafe) cvn //null
(.setshapealpha) cvn //null
(.settextknockout) cvn //null
(.tempfile) cvn //null
(arccos) cvn //null
(arcsin) cvn //null
(copydevice) cvn //null
(copyscanlines) cvn //null
(currentdevice) cvn //null
(finddevice) cvn //null
(findlibfile) cvn //null
(findprotodevice) cvn //null
(getdeviceprops) cvn //null
(getenv) cvn //null
(makeimagedevice) cvn //null
(max) cvn //null
(min) cvn //null
(.genordered) cvn //null
(.setpdfwrite) cvn //null
(putdeviceprops) cvn //null
(setdevice) cvn //null
(.password) cvn //null
(.timeouts) cvn //null
(11x17) cvn //null
(11x17tray) cvn //null
(a0) cvn //null
(a1) cvn //null
(a10) cvn //null
(a2) cvn //null
(a3) cvn //null
(a3tray) cvn //null
(a4) cvn //null
(a4small) cvn //null
(a4tray) cvn //null
(a5) cvn //null
(a5tray) cvn //null
(a6) cvn //null
(a6tray) cvn //null
(a7) cvn //null
(a8) cvn //null
(a9) cvn //null
(allowjobreset) cvn //null
(ANSI_A) cvn //null
(ANSI_B) cvn //null
(ANSI_C) cvn //null
(ANSI_D) cvn //null
(ANSI_E) cvn //null
(ANSI_F) cvn //null
(appletalktype) cvn //null
(archA) cvn //null
(archB) cvn //null
(archC) cvn //null
(archD) cvn //null
(archE) cvn //null
(b0) cvn //null
(b1) cvn //null
(b2) cvn //null
(b3) cvn //null
(b4) cvn //null
(b4tray) cvn //null
(b5) cvn //null
(b5tray) cvn //null
(b6) cvn //null
(c0) cvn //null
(c1) cvn //null
(c2) cvn //null
(c3) cvn //null
(c4) cvn //null
(c5) cvn //null
(c6) cvn //null
(checkpassword) cvn //null
(defaultpaperfamily) cvn //null
(defaultpapertray) cvn //null
(defaulttimeouts) cvn //null
(defaulttrayswitch) cvn //null
(devforall) cvn //null
(devformat) cvn //null
(devstatus) cvn //null
(diskonline) cvn //null
(diskstatus) cvn //null
(dosysstart) cvn //null
(eescratch) cvn //null
(execjob) cvn //null
(exitserver) cvn //null
(flsa) cvn //null
(flsatray) cvn //null
(flse) cvn //null
(flsetray) cvn //null
(hagaki) cvn //null
(halfletter) cvn //null
(halflettertray) cvn //null
(hardwareiomode) cvn //null
(idlefonts) cvn //null
(isob0) cvn //null
(isob1) cvn //null
(isob2) cvn //null
(isob3) cvn //null
(isob4) cvn //null
(isob5) cvn //null
(isob6) cvn //null
(jisb0) cvn //null
(jisb1) cvn //null
(jisb2) cvn //null
(jisb3) cvn //null
(jisb4) cvn //null
(jisb5) cvn //null
(jisb6) cvn //null
(jobname) cvn //null
(ledger) cvn //null
(ledgertray) cvn //null
(legal) cvn //null
(legaltray) cvn //null
(letter) cvn //null
(lettersmall) cvn //null
(lettertray) cvn //null
(manualfeed) cvn //null
(manualfeedtimeout) cvn //null
(margins) cvn //null
(note) cvn //null
(pa4) cvn //null
(pagecount) cvn //null
(pagemargin) cvn //null
(pageparams) cvn //null
(pagestackorder) cvn //null
(pagetype) cvn //null
(paperfamily) cvn //null
(papertray) cvn //null
(prefeed) cvn //null
(printererror) cvn //null
(printername) cvn //null
(processcolors) cvn //null
(product) cvn //null
(ramsize) cvn //null
(revision) cvn //null
(sccbatch) cvn //null
(sccinteractive) cvn //null
(setallowjobreset) cvn //null
(setdefaultpaperfamily) cvn //null
(setdefaultpapertray) cvn //null
(setdefaulttimeouts) cvn //null
(setdefaulttrayswitch) cvn //null
(setdostartpage) cvn //null
(setdosysstart) cvn //null
(setduplexmode) cvn //null
(seteescratch) cvn //null
(sethardwareiomode) cvn //null
(setidlefonts) cvn //null
(setjobtimeout) cvn //null
(setmargins) cvn //null
(setpage) cvn //null
(setpagemargin) cvn //null
(setpageparams) cvn //null
(setpagetype) cvn //null
(setpapertray) cvn //null
(setpassword) cvn //null
(setprintername) cvn //null
(setrealdevice) cvn //null
(setresolution) cvn //null
(setsccbatch) cvn //null
(setsccinteractive) cvn //null
(setsoftwareiomode) cvn //null
(settumble) cvn //null
(softwareiomode) cvn //null
(tabloid) cvn //null
(trayswitch) cvn //null
(waittimeout) cvn //null
(--AdobeGlyphList--) cvn //null
(--ReverseAdobeGlyphList--) cvn //null
(--$error--) cvn //null
(--[--) cvn //null
(--]--) cvn //null
(--<<--) cvn //null
(--=--) cvn //null
(--==--) cvn //null
(-->>--) cvn //null
(--abs--) cvn //null
(--add--) cvn //null
(--aload--) cvn //null
(--anchorsearch--) cvn //null
(--and--) cvn //null
(--arc--) cvn //null
(--arcn--) cvn //null
(--arct--) cvn //null
(--arcto--) cvn //null
(--array--) cvn //null
(--ashow--) cvn //null
(--astore--) cvn //null
(--atan--) cvn //null
(--awidthshow--) cvn //null
(--begin--) cvn //null
(--bind--) cvn //null
(--bitshift--) cvn //null
(--bytesavailable--) cvn //null
(--ceiling--) cvn //null
(--charpath--) cvn //null
(--clear--) cvn //null
(--cleardictstack--) cvn //null
(--cleartomark--) cvn //null
(--clip--) cvn //null
(--clippath--) cvn //null
(--cliprestore--) cvn //null
(--clipsave--) cvn //null
(--closefile--) cvn //null
(--closepath--) cvn //null
(--colorimage--) cvn //null
(--composefont--) cvn //null
(--concat--) cvn //null
(--concatmatrix--) cvn //null
(--copy--) cvn //null
(--copypage--) cvn //null
(--cos--) cvn //null
(--count--) cvn //null
(--countdictstack--) cvn //null
(--countexecstack--) cvn //null
(--counttomark--) cvn //null
(--cshow--) cvn //null
(--currentblackgeneration--) cvn //null
(--currentcacheparams--) cvn //null
(--currentcmykcolor--) cvn //null
(--currentcolor--) cvn //null
(--currentcolorrendering--) cvn //null
(--currentcolorscreen--) cvn //null
(--currentcolorspace--) cvn //null
(--currentcolortransfer--) cvn //null
(--currentdash--) cvn //null
(--currentdevparams--) cvn //null
(--currentdict--) cvn //null
(--currentfile--) cvn //null
(--currentflat--) cvn //null
(--currentglobal--) cvn //null
(--currentgray--) cvn //null
(--currentgstate--) cvn //null
(--currenthalftone--) cvn //null
(--currenthsbcolor--) cvn //null
(--currentlinecap--) cvn //null
(--currentlinejoin--) cvn //null
(--currentlinewidth--) cvn //null
(--currentmatrix--) cvn //null
(--currentmiterlimit--) cvn //null
(--currentobjectformat--) cvn //null
(--currentoverprint--) cvn //null
(--currentpacking--) cvn //null
(--currentpagedevice--) cvn //null
(--currentpoint--) cvn //null
(--currentrgbcolor--) cvn //null
(--currentscreen--) cvn //null
(--currentsmoothness--) cvn //null
(--currentstrokeadjust--) cvn //null
(--currentsystemparams--) cvn //null
(--currenttransfer--) cvn //null
(--currentundercolorremoval--) cvn //null
(--currentuserparams--) cvn //null
(--curveto--) cvn //null
(--cvi--) cvn //null
(--cvlit--) cvn //null
(--cvn--) cvn //null
(--cvr--) cvn //null
(--cvrs--) cvn //null
(--cvs--) cvn //null
(--cvx--) cvn //null
(--def--) cvn //null
(--defaultmatrix--) cvn //null
(--definefont--) cvn //null
(--defineresource--) cvn //null
(--defineuserobject--) cvn //null
(--deletefile--) cvn //null
(--dict--) cvn //null
(--dictstack--) cvn //null
(--div--) cvn //null
(--dtransform--) cvn //null
(--dup--) cvn //null
(--echo--) cvn //null
(--end--) cvn //null
(--eoclip--) cvn //null
(--eofill--) cvn //null
(--eq--) cvn //null
(--erasepage--) cvn //null
(--errordict--) cvn //null
(--exch--) cvn //null
(--exec--) cvn //null
(--execform--) cvn //null
(--execstack--) cvn //null
(--execuserobject--) cvn //null
(--executeonly--) cvn //null
(--executive--) cvn //null
(--exit--) cvn //null
(--exp--) cvn //null
(--false--) cvn //null
(--file--) cvn //null
(--filenameforall--) cvn //null
(--fileposition--) cvn //null
(--fill--) cvn //null
(--filter--) cvn //null
(--findcolorrendering--) cvn //null
(--findencoding--) cvn //null
(--findfont--) cvn //null
(--findresource--) cvn //null
(--flattenpath--) cvn //null
(--floor--) cvn //null
(--flush--) cvn //null
(--flushfile--) cvn //null
(--FontDirectory--) cvn //null
(--for--) cvn //null
(--forall--) cvn //null
(--gcheck--) cvn //null
(--ge--) cvn //null
(--get--) cvn //null
(--getinterval--) cvn //null
(--globaldict--) cvn //null
(--GlobalFontDirectory--) cvn //null
(--glyphshow--) cvn //null
(--grestore--) cvn //null
(--grestoreall--) cvn //null
(--gsave--) cvn //null
(--gstate--) cvn //null
(--gt--) cvn //null
(--identmatrix--) cvn //null
(--idiv--) cvn //null
(--idtransform--) cvn //null
(--if--) cvn //null
(--ifelse--) cvn //null
(--image--) cvn //null
(--imagemask--) cvn //null
(--index--) cvn //null
(--ineofill--) cvn //null
(--infill--) cvn //null
(--initclip--) cvn //null
(--initgraphics--) cvn //null
(--initmatrix--) cvn //null
(--instroke--) cvn //null
(--inueofill--) cvn //null
(--inufill--) cvn //null
(--inustroke--) cvn //null
(--invertmatrix--) cvn //null
(--ISOLatin1Encoding--) cvn //null
(--itransform--) cvn //null
(--known--) cvn //null
(--kshow--) cvn //null
(--languagelevel--) cvn //null
(--le--) cvn //null
(--length--) cvn //null
(--lineto--) cvn //null
(--ln--) cvn //null
(--load--) cvn //null
(--log--) cvn //null
(--loop--) cvn //null
(--lt--) cvn //null
(--makefont--) cvn //null
(--makepattern--) cvn //null
(--mark--) cvn //null
(--matrix--) cvn //null
(--maxlength--) cvn //null
(--mod--) cvn //null
(--moveto--) cvn //null
(--mul--) cvn //null
(--ne--) cvn //null
(--neg--) cvn //null
(--newpath--) cvn //null
(--noaccess--) cvn //null
(--not--) cvn //null
(--null--) cvn //null
(--nulldevice--) cvn //null
(--or--) cvn //null
(--packedarray--) cvn //null
(--pathbbox--) cvn //null
(--pathforall--) cvn //null
(--pop--) cvn //null
(--printobject--) cvn //null
(--product--) cvn //null
(--prompt--) cvn //null
(--pstack--) cvn //null
(--put--) cvn //null
(--putinterval--) cvn //null
(--quit--) cvn //null
(--rand--) cvn //null
(--rcheck--) cvn //null
(--rcurveto--) cvn //null
(--read--) cvn //null
(--readhexstring--) cvn //null
(--readline--) cvn //null
(--readonly--) cvn //null
(--readstring--) cvn //null
(--realtime--) cvn //null
(--rectclip--) cvn //null
(--rectfill--) cvn //null
(--rectstroke--) cvn //null
(--renamefile--) cvn //null
(--repeat--) cvn //null
(--resetfile--) cvn //null
(--resourceforall--) cvn //null
(--resourcestatus--) cvn //null
(--restore--) cvn //null
(--reversepath--) cvn //null
(--revision--) cvn //null
(--rlineto--) cvn //null
(--rmoveto--) cvn //null
(--roll--) cvn //null
(--rotate--) cvn //null
(--round--) cvn //null
(--rrand--) cvn //null
(--run--) cvn //null
(--save--) cvn //null
(--scale--) cvn //null
(--scalefont--) cvn //null
(--search--) cvn //null
(--selectfont--) cvn //null
(--serialnumber--) cvn //null
(--setbbox--) cvn //null
(--setblackgeneration--) cvn //null
(--setcachedevice--) cvn //null
(--setcachedevice2--) cvn //null
(--setcachelimit--) cvn //null
(--setcacheparams--) cvn //null
(--setcharwidth--) cvn //null
(--setcmykcolor--) cvn //null
(--setcolor--) cvn //null
(--setcolorrendering--) cvn //null
(--setcolorscreen--) cvn //null
(--setcolorspace--) cvn //null
(--setcolortransfer--) cvn //null
(--setdash--) cvn //null
(--setdevparams--) cvn //null
(--setfileposition--) cvn //null
(--setflat--) cvn //null
(--setfont--) cvn //null
(--setglobal--) cvn //null
(--setgray--) cvn //null
(--setgstate--) cvn //null
(--sethalftone--) cvn //null
(--sethsbcolor--) cvn //null
(--setlinecap--) cvn //null
(--setlinejoin--) cvn //null
(--setlinewidth--) cvn //null
(--setmatrix--) cvn //null
(--setmiterlimit--) cvn //null
(--setobjectformat--) cvn //null
(--setoverprint--) cvn //null
(--setpacking--) cvn //null
(--setpagedevice--) cvn //null
(--setpattern--) cvn //null
(--setrgbcolor--) cvn //null
(--setscreen--) cvn //null
(--setsmoothness--) cvn //null
(--setstrokeadjust--) cvn //null
(--setsystemparams--) cvn //null
(--settransfer--) cvn //null
(--setucacheparams--) cvn //null
(--setundercolorremoval--) cvn //null
(--setuserparams--) cvn //null
(--setvmthreshold--) cvn //null
(--shfill--) cvn //null
(--show--) cvn //null
(--showpage--) cvn //null
(--sin--) cvn //null
(--sqrt--) cvn //null
(--srand--) cvn //null
(--stack--) cvn //null
(--StandardEncoding--) cvn //null
(--start--) cvn //null
(--startjob--) cvn //null
(--status--) cvn //null
(--stop--) cvn //null
(--stopped--) cvn //null
(--store--) cvn //null
(--string--) cvn //null
(--stringwidth--) cvn //null
(--stroke--) cvn //null
(--strokepath--) cvn //null
(--sub--) cvn //null
(--systemdict--) cvn //null
(--token--) cvn //null
(--transform--) cvn //null
(--translate--) cvn //null
(--true--) cvn //null
(--truncate--) cvn //null
(--type--) cvn //null
(--uappend--) cvn //null
(--ucache--) cvn //null
(--ucachestatus--) cvn //null
(--ueofill--) cvn //null
(--ufill--) cvn //null
(--undef--) cvn //null
(--undefinefont--) cvn //null
(--undefineresource--) cvn //null
(--undefineuserobject--) cvn //null
(--upath--) cvn //null
(--userdict--) cvn //null
(--UserObjects--) cvn //null
(--usertime--) cvn //null
(--ustroke--) cvn //null
(--ustrokepath--) cvn //null
(--version--) cvn //null
(--vmreclaim--) cvn //null
(--vmstatus--) cvn //null
(--wcheck--) cvn //null
(--where--) cvn //null
(--widthshow--) cvn //null
(--write--) cvn //null
(--writehexstring--) cvn //null
(--writeobject--) cvn //null
(--writestring--) cvn //null
(--xcheck--) cvn //null
(--xor--) cvn //null
(--xshow--) cvn //null
(--xyshow--) cvn //null
(--yshow--) cvn //null
(--%Type1BuildChar--) cvn //null
(--%Type1BuildGlyph--) cvn //null
(--.begintransparencygroup--) cvn //null
(--.begintransparencymaskgroup--) cvn //null
(--.bind--) cvn //null
(--.bindnow--) cvn //null
(--.currentoverprintmode--) cvn //null
(--.dicttomark--) cvn //null
(--.endtransparencygroup--) cvn //null
(--.fileposition--) cvn //null
(--.knownget--) cvn //null
(--.locksafe--) cvn //null
(--.makeoperator--) cvn //null
(--.setblendmode--) cvn //null
(--.setdebug--) cvn //null
(--.setopacityalpha--) cvn //null
(--.setoverprintmode--) cvn //null
(--.setsafe--) cvn //null
(--.setshapealpha--) cvn //null
(--.settextknockout--) cvn //null
(--.tempfile--) cvn //null
(--arccos--) cvn //null
(--arcsin--) cvn //null
(--copydevice--) cvn //null
(--copyscanlines--) cvn //null
(--currentdevice--) cvn //null
(--finddevice--) cvn //null
(--findlibfile--) cvn //null
(--findprotodevice--) cvn //null
(--getdeviceprops--) cvn //null
(--getenv--) cvn //null
(--makeimagedevice--) cvn //null
(--max--) cvn //null
(--min--) cvn //null
(--.genordered--) cvn //null
(--.setpdfwrite--) cvn //null
(--putdeviceprops--) cvn //null
(--setdevice--) cvn //null
(--.password--) cvn //null
(--.timeouts--) cvn //null
(--11x17--) cvn //null
(--11x17tray--) cvn //null
(--a0--) cvn //null
(--a1--) cvn //null
(--a10--) cvn //null
(--a2--) cvn //null
(--a3--) cvn //null
(--a3tray--) cvn //null
(--a4--) cvn //null
(--a4small--) cvn //null
(--a4tray--) cvn //null
(--a5--) cvn //null
(--a5tray--) cvn //null
(--a6--) cvn //null
(--a6tray--) cvn //null
(--a7--) cvn //null
(--a8--) cvn //null
(--a9--) cvn //null
(--allowjobreset--) cvn //null
(--ANSI_A--) cvn //null
(--ANSI_B--) cvn //null
(--ANSI_C--) cvn //null
(--ANSI_D--) cvn //null
(--ANSI_E--) cvn //null
(--ANSI_F--) cvn //null
(--appletalktype--) cvn //null
(--archA--) cvn //null
(--archB--) cvn //null
(--archC--) cvn //null
(--archD--) cvn //null
(--archE--) cvn //null
(--b0--) cvn //null
(--b1--) cvn //null
(--b2--) cvn //null
(--b3--) cvn //null
(--b4--) cvn //null
(--b4tray--) cvn //null
(--b5--) cvn //null
(--b5tray--) cvn //null
(--b6--) cvn //null
(--c0--) cvn //null
(--c1--) cvn //null
(--c2--) cvn //null
(--c3--) cvn //null
(--c4--) cvn //null
(--c5--) cvn //null
(--c6--) cvn //null
(--checkpassword--) cvn //null
(--defaultpaperfamily--) cvn //null
(--defaultpapertray--) cvn //null
(--defaulttimeouts--) cvn //null
(--defaulttrayswitch--) cvn //null
(--devforall--) cvn //null
(--devformat--) cvn //null
(--devstatus--) cvn //null
(--diskonline--) cvn //null
(--diskstatus--) cvn //null
(--dosysstart--) cvn //null
(--eescratch--) cvn //null
(--execjob--) cvn //null
(--exitserver--) cvn //null
(--flsa--) cvn //null
(--flsatray--) cvn //null
(--flse--) cvn //null
(--flsetray--) cvn //null
(--hagaki--) cvn //null
(--halfletter--) cvn //null
(--halflettertray--) cvn //null
(--hardwareiomode--) cvn //null
(--idlefonts--) cvn //null
(--isob0--) cvn //null
(--isob1--) cvn //null
(--isob2--) cvn //null
(--isob3--) cvn //null
(--isob4--) cvn //null
(--isob5--) cvn //null
(--isob6--) cvn //null
(--jisb0--) cvn //null
(--jisb1--) cvn //null
(--jisb2--) cvn //null
(--jisb3--) cvn //null
(--jisb4--) cvn //null
(--jisb5--) cvn //null
(--jisb6--) cvn //null
(--jobname--) cvn //null
(--ledger--) cvn //null
(--ledgertray--) cvn //null
(--legal--) cvn //null
(--legaltray--) cvn //null
(--letter--) cvn //null
(--lettersmall--) cvn //null
(--lettertray--) cvn //null
(--manualfeed--) cvn //null
(--manualfeedtimeout--) cvn //null
(--margins--) cvn //null
(--note--) cvn //null
(--pa4--) cvn //null
(--pagecount--) cvn //null
(--pagemargin--) cvn //null
(--pageparams--) cvn //null
(--pagestackorder--) cvn //null
(--pagetype--) cvn //null
(--paperfamily--) cvn //null
(--papertray--) cvn //null
(--prefeed--) cvn //null
(--printererror--) cvn //null
(--printername--) cvn //null
(--processcolors--) cvn //null
(--product--) cvn //null
(--ramsize--) cvn //null
(--revision--) cvn //null
(--sccbatch--) cvn //null
(--sccinteractive--) cvn //null
(--setallowjobreset--) cvn //null
(--setdefaultpaperfamily--) cvn //null
(--setdefaultpapertray--) cvn //null
(--setdefaulttimeouts--) cvn //null
(--setdefaulttrayswitch--) cvn //null
(--setdostartpage--) cvn //null
(--setdosysstart--) cvn //null
(--setduplexmode--) cvn //null
(--seteescratch--) cvn //null
(--sethardwareiomode--) cvn //null
(--setidlefonts--) cvn //null
(--setjobtimeout--) cvn //null
(--setmargins--) cvn //null
(--setpage--) cvn //null
(--setpagemargin--) cvn //null
(--setpageparams--) cvn //null
(--setpagetype--) cvn //null
(--setpapertray--) cvn //null
(--setpassword--) cvn //null
(--setprintername--) cvn //null
(--setrealdevice--) cvn //null
(--setresolution--) cvn //null
(--setsccbatch--) cvn //null
(--setsccinteractive--) cvn //null
(--setsoftwareiomode--) cvn //null
(--settumble--) cvn //null
(--softwareiomode--) cvn //null
(--tabloid--) cvn //null
(--trayswitch--) cvn //null
(--waittimeout--) cvn //null

%% Manually added
%% These are official from some tech note or something
(customcolorimage) cvn //null
(findcmykcustomcolor) cvn //null
(findrgbcustomcolor) cvn //null
(separationimage) cvn //null
(setcmykoverprint) cvn //null
(setcustomcolor) cvn //null
(setseparationgray) cvn //null
(--customcolorimage--) cvn //null
(--findcmykcustomcolor--) cvn //null
(--findrgbcustomcolor--) cvn //null
(--separationimage--) cvn //null
(--setcmykoverprint--) cvn //null
(--setcustomcolor--) cvn //null
(--setseparationgray--) cvn //null


>> def

/systemdict systemdict check_dictionary

(######################################################################################) =

[ operator_list { pop } forall ]
/.sort where { pop { 100 string cvs exch 100 string cvs gt } .sort } if
{ whitelist 1 index 100 string cvs cvn known not {
    dup =only (  ) print operator_list exch get ===
  } {
    /SCANDEBUG where { pop (skipping ') dup =only (') = flush } if
    pop
  }
  ifelse
} forall

(######################################################################################) =
(\nChecking internal dictionaries returned by operators\n) =
/currentcolorrendering currentcolorrendering check_dictionary
/currenthalftone currenthalftone check_dictionary
/currentpagedevice currentpagedevice check_dictionary
/currentsystemparams currentsystemparams check_dictionary
%%%/currenttrapparams currenttrapparams check_dictionary
/currentuserparams currentuserparams check_dictionary

(*)
{ (currentdevparams/) 1 index concatstrings cvn exch currentdevparams check_dictionary }
100 string
/IODevice
resourceforall

(######################################################################################) =
(\nusage from operator_list capture\n) =
operator_list {
  whitelist 2 index 100 string cvs cvn known not {
    exch =only (	defined in: ) print dup { /def eq { =only (, ) print } { pop } ifelse } forall
    () =
    (	referenced by: ) print  { /ref eq { =only (, ) print } { pop } ifelse } forall
    () =
  } {
    pop
    /SCANDEBUG where { pop (skipping ') print dup =only (') = flush } if
    pop
  }
  ifelse
} forall
quit
